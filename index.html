<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Nano Bank</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
:root{
  --bg:#f1f5f9;
  --card:#ffffff;
  --text:#0f172a;
  --accent:#2563eb;
}
body.dark{
  --bg:#020617;
  --card:#0f172a;
  --text:#e5e7eb;
  --accent:#22d3ee;
}
body{
  margin:0;
  font-family:system-ui, sans-serif;
  background:var(--bg);
  color:var(--text);
  display:flex;
  justify-content:center;
}
.app{
  max-width:900px;
  width:100%;
  padding:20px;
}
.card{
  background:var(--card);
  border-radius:16px;
  padding:16px;
  margin-bottom:15px;
  box-shadow:0 10px 25px rgba(0,0,0,.1);
}
h1{margin:0 0 10px;}
select,input,button{
  width:100%;
  padding:10px;
  margin-top:8px;
  border-radius:10px;
  border:none;
}
body.dark select, body.dark input{background:#020617; color:white;}
button{
  background:var(--accent);
  color:white;
  font-weight:600;
  cursor:pointer;
}
.row{display:flex; gap:10px;}
.history{
  max-height:260px;
  overflow:auto;
  font-size:14px;
}
.tx{
  padding:6px 0;
  border-bottom:1px solid rgba(0,0,0,.15);
}
.balance{
  font-size:30px;
  font-weight:700;
}
.theme-toggle{
  position:fixed;
  top:14px;
  right:14px;
  width:42px;
  height:42px;
  border-radius:50%;
  background:var(--card);
  border:none;
  font-size:20px;
  cursor:pointer;
}
#goToClicker{
  font-size:18px;
  padding:12px;
  border-radius:12px;
  background:#ffcc00;
  color:#222;
  border:none;
  cursor:pointer;
  font-weight:600;
  margin:15px 0;
}
</style>
</head>

<body>

<button class="theme-toggle" id="themeBtn">üåô</button>

<div class="app">
<h1>üè¶ Nano Bank</h1>

<button id="goToClicker">üí∞ Go to Clicker Game</button>

<select id="accountSelect"></select>
<input type="text" id="newAccount" placeholder="Create account">
<div class="row">
  <button onclick="addAccount()">Add Account</button>
  <button onclick="deleteAccount()">Delete Account</button>
</div>

<div style="margin-top:8px;font-weight:bold;">
Current Account: <span id="currentAccountDisplay"></span>
</div>

<div class="card">
  <div class="balance">$<span id="balance">0</span></div>
  <input type="number" id="amount" placeholder="Amount">

  <!-- SINGLE WITHDRAW BUTTON -->
  <div class="row">
    <button onclick="withdraw()">Withdraw</button>
  </div>

  <h3>Transfer</h3>
  <select id="toAccount"></select>
  <input type="number" id="transferAmount" placeholder="Amount">
  <button onclick="transfer()">Send</button>
</div>

<div class="card">
  <h3>Transactions</h3>
  <div class="history" id="history"></div>
</div>
</div>

<script>
// ===== DATA =====
let bank = JSON.parse(localStorage.getItem("bank")) || {
  theme:"light",
  current:"Main",
  accounts:{ Main:{balance:0, transactions:[]} }
};

// ===== THEME =====
const themeBtn = document.getElementById("themeBtn");
if(bank.theme==="dark"){
  document.body.classList.add("dark");
  themeBtn.textContent="‚òÄÔ∏è";
}
themeBtn.onclick=()=>{
  document.body.classList.toggle("dark");
  bank.theme=document.body.classList.contains("dark")?"dark":"light";
  themeBtn.textContent=bank.theme==="dark"?"‚òÄÔ∏è":"üåô";
  save();
};

// ===== ELEMENTS =====
const accountSelect=document.getElementById("accountSelect");
const toAccount=document.getElementById("toAccount");
const balanceEl=document.getElementById("balance");
const historyEl=document.getElementById("history");
const newAccountInput=document.getElementById("newAccount");
const amountInput=document.getElementById("amount");
const transferInput=document.getElementById("transferAmount");
const currentAccountDisplay=document.getElementById("currentAccountDisplay");

// ===== SAVE =====
function save(){
  localStorage.setItem("bank",JSON.stringify(bank));
}

// ===== LOAD =====
function loadAccounts(){
  accountSelect.innerHTML="";
  toAccount.innerHTML="";
  for(let acc in bank.accounts){
    let o=document.createElement("option");
    o.value=o.text=acc;
    accountSelect.appendChild(o);
    if(acc!==bank.current){
      let o2=document.createElement("option");
      o2.value=o2.text=acc;
      toAccount.appendChild(o2);
    }
  }
  accountSelect.value=bank.current;
  currentAccountDisplay.textContent=bank.current;
}

// ===== RENDER =====
function render(){
  const acc=bank.accounts[bank.current];
  balanceEl.textContent=acc.balance;
  historyEl.innerHTML="";
  acc.transactions.slice().reverse().forEach(tx=>{
    const d=document.createElement("div");
    d.className="tx";
    d.textContent=`${tx.type} $${tx.amount} ‚Üí ${tx.note} (${tx.time})`;
    historyEl.appendChild(d);
  });
}

// ===== SWITCH =====
accountSelect.onchange=()=>{
  bank.current=accountSelect.value;
  loadAccounts();
  render();
  save();
};

// ===== ADD ACCOUNT =====
function addAccount(){
  const n=newAccountInput.value.trim();
  if(!n||bank.accounts[n])return alert("Invalid name");
  bank.accounts[n]={balance:0,transactions:[]};
  bank.current=n;
  newAccountInput.value="";
  loadAccounts();render();save();
}

// ===== DELETE =====
function deleteAccount(){
  if(confirm("Delete account?")&&confirm("Permanent?")){
    delete bank.accounts[bank.current];
    bank.current=Object.keys(bank.accounts)[0];
    loadAccounts();render();save();
  }
}

// ===== WITHDRAW ‚Üí CLICKER =====
function withdraw(){
  const amt=parseFloat(amountInput.value);
  if(!amt||amt<=0)return alert("Invalid amount");

  const acc=bank.accounts[bank.current];
  if(amt>acc.balance)return alert("Insufficient funds");

  // Load clicker
  let clicker=JSON.parse(localStorage.getItem("clickerAccounts"))||{};
  if(!clicker[bank.current]) clicker[bank.current]=0;

  // Transfer
  acc.balance-=amt;
  clicker[bank.current]+=amt;

  acc.transactions.push({
    type:"Withdraw to Clicker",
    amount:amt,
    note:"Clicker Game",
    time:new Date().toLocaleString()
  });

  localStorage.setItem("clickerAccounts",JSON.stringify(clicker));
  amountInput.value="";
  render();save();

  alert(`$${amt} sent to Clicker account "${bank.current}"`);
}

// ===== TRANSFER =====
function transfer(){
  const amt=parseFloat(transferInput.value);
  const t=toAccount.value;
  if(!amt||amt<=0||!t)return alert("Invalid");
  const f=bank.accounts[bank.current];
  if(amt>f.balance)return alert("No funds");
  f.balance-=amt;
  bank.accounts[t].balance+=amt;
  const time=new Date().toLocaleString();
  f.transactions.push({type:"Transfer Out",amount:amt,note:t,time});
  bank.accounts[t].transactions.push({type:"Transfer In",amount:amt,note:bank.current,time});
  transferInput.value="";
  render();save();
}

// ===== NAV =====
document.getElementById("goToClicker").onclick=()=>{
  window.location.href="clicker.html";
};

// ===== INIT =====
loadAccounts();
render();
</script>

</body>
</html>
